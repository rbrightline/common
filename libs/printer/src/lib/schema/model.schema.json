{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "ModelOptions",
    "properties": {
        "extends": {
            "$ref": "#/definitions/ModelName",
            "description": "Which abstract model is extended by the entity?"
        },
        "uniques": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/PropertyName"
            }
        },
        "properties": {
            "type": "array",
            "uniqueItems": true,
            "items": {
                "$ref": "#/definitions/PropertyOptions"
            }
        },
        "relations": {
            "type": "array",
            "uniqueItems": true,
            "items": {
                "$ref": "#/definitions/RelationPropertyOptions"
            }
        }
    },
    "additionalProperties": false,
    "definitions": {
        "ModelName": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "ModelName",
            "enum": [
                "User",
                "Product"
            ]
        },
        "PropertyName": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "PropertyName",
            "enum": [
                "firstName",
                "lastName"
            ]
        },
        "PropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "PropertyOptions",
            "allOf": [
                {
                    "$ref": "#/definitions/CommonPropertyOptions"
                },
                {
                    "$ref": "#/definitions/UIPropertyOptions"
                },
                {
                    "oneOf": [
                        {
                            "$ref": "#/definitions/StringPropertyOptions"
                        },
                        {
                            "$ref": "#/definitions/NumberPropertyOptions"
                        },
                        {
                            "$ref": "#/definitions/IntegerPropertyOptions"
                        },
                        {
                            "$ref": "#/definitions/BooleanPropertyOptions"
                        },
                        {
                            "$ref": "#/definitions/DatePropertyOptions"
                        },
                        {
                            "$ref": "#/definitions/ObjectPropertyOptions"
                        },
                        {
                            "$ref": "#/definitions/ArrayPropertyOptions"
                        }
                    ]
                }
            ]
        },
        "RelationPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "RelationPropertyOptions",
            "allOf": [
                {
                    "$ref": "#/definitions/UIPropertyOptions"
                },
                {
                    "properties": {
                        "name": {
                            "$ref": "#/definitions/PropertyName"
                        },
                        "type": {
                            "$ref": "#/definitions/RelationType"
                        },
                        "target": {
                            "$ref": "#/definitions/ModelName"
                        },
                        "targetProperty": {
                            "description": "Reference property in the target entity",
                            "$ref": "#/definitions/PropertyName"
                        },
                        "eager": {
                            "type": "boolean",
                            "default": true
                        },
                        "join": {
                            "description": "should join the column/table?",
                            "type": "boolean",
                            "default": true
                        },
                        "cascade": {
                            "description": "should cascade the realtion during entity creation",
                            "type": "boolean",
                            "default": true
                        },
                        "onDelete": {
                            "description": "what should happen when the relation is deleted?",
                            "$ref": "#/definitions/OnDelete",
                            "default": "SET NULL"
                        },
                        "onUpdate": {
                            "description": "what should happen when the relation is udpated",
                            "$ref": "#/definitions/OnUpdate"
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "type",
                        "target"
                    ]
                }
            ]
        },
        "RelationType": {
            "title": "Relation Type",
            "enum": [
                "many-to-many",
                "many-to-one",
                "one-to-one",
                "one-to-many"
            ]
        },
        "OnDelete": {
            "enum": [
                "RESTRICT",
                "CASCADE",
                "SET NULL",
                "DEFAULT",
                "NO ACTION"
            ],
            "default": "SET NULL"
        },
        "OnUpdate": {
            "enum": [
                "RESTRICT",
                "CASCADE",
                "SET NULL",
                "DEFAULT",
                "NO ACTION"
            ],
            "default": "SET NULL"
        },
        "NumberFormat": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "NumberFormat",
            "description": "Number format such as rate (0-5), percentage (0-100)",
            "enum": [
                [
                    "integer",
                    "float"
                ]
            ]
        },
        "CommonNumberPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "CommonNumberPropertyOptions",
            "properties": {
                "numberFormat": {
                    "$ref": "#/definitions/NumberFormat"
                },
                "minimum": {
                    "type": "number"
                },
                "maximum": {
                    "type": "number"
                },
                "moreThanProperty": {
                    "$ref": "#/definitions/PropertyName"
                },
                "lessThanProperty": {
                    "$ref": "#/definitions/PropertyName"
                }
            }
        },
        "CommonPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "CommonPropertyOptions",
            "allOf": [
                {
                    "$ref": "#/definitions/General"
                },
                {
                    "$ref": "#/definitions/Transform"
                },
                {
                    "$ref": "#/definitions/Validation"
                },
                {
                    "$ref": "#/definitions/Encryption"
                },
                {
                    "$ref": "#/definitions/Dto"
                }
            ],
            "definitions": {
                "General": {
                    "properties": {
                        "name": {
                            "$ref": "#/definitions/PropertyName"
                        },
                        "description": {
                            "type": "string"
                        },
                        "required": {
                            "type": "boolean",
                            "default": true
                        },
                        "unique": {
                            "type": "boolean",
                            "default": true
                        }
                    }
                },
                "Transform": {
                    "properties": {
                        "acceptString": {
                            "type": "boolean",
                            "description": "transform string values into the actual type before any operations",
                            "default": true
                        }
                    }
                },
                "Validation": {
                    "properties": {
                        "equalToProperty": {
                            "$ref": "#/definitions/PropertyName",
                            "description": "Check the value is equal to the value of the property"
                        },
                        "notEqualToProperty": {
                            "$ref": "#/definitions/PropertyName",
                            "description": "Check the value is not equal to the value of the property"
                        }
                    }
                },
                "Encryption": {
                    "properties": {
                        "hash": {
                            "type": "boolean",
                            "default": true
                        },
                        "encrypt": {
                            "type": "boolean",
                            "default": true
                        }
                    }
                },
                "Dto": {
                    "properties": {
                        "write": {
                            "type": "boolean",
                            "description": "Is the property writable or internal"
                        },
                        "read": {
                            "type": "boolean",
                            "description": "Is the property visible in the data load?",
                            "default": true
                        },
                        "udpate": {
                            "type": "boolean",
                            "description": "Is proprety updatable?",
                            "default": true
                        }
                    }
                }
            },
            "required": [
                "type",
                "name"
            ]
        },
        "UIPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "UIPropertyOptions",
            "properties": {
                "label": {
                    "type": "string"
                },
                "mapTo": {
                    "$ref": "#/definitions/PropertyName"
                },
                "inputType": {
                    "$ref": "#/definitions/InputType"
                },
                "prefixText": {
                    "type": "string"
                },
                "suffixText": {
                    "type": "string"
                },
                "prefixIcon": {
                    "$ref": "#/definitions/Icon"
                },
                "suffixIcon": {
                    "$ref": "#/definitions/Icon"
                },
                "dependsOn": {
                    "$ref": "#/definitions/PropertyName"
                },
                "group": {
                    "type": "string"
                },
                "bold": {
                    "type": "boolean"
                },
                "italic": {
                    "type": "boolean"
                }
            }
        },
        "StringPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "StringPropertyOptions",
            "properties": {
                "type": {
                    "const": "string"
                },
                "default": {
                    "type": "string"
                },
                "stringFormat": {
                    "$ref": "#/definitions/StringFormat"
                },
                "minLength": {
                    "type": "integer"
                },
                "maxLength": {
                    "type": "integer"
                },
                "isIn": {
                    "type": "array",
                    "uniqueItems": true,
                    "items": {
                        "type": "string"
                    }
                },
                "isNotIn": {
                    "type": "array",
                    "uniqueItems": true,
                    "items": {
                        "type": "string"
                    }
                },
                "contains": {
                    "type": "array",
                    "uniqueItems": true,
                    "items": {
                        "type": "string"
                    }
                },
                "notContains": {
                    "type": "array",
                    "uniqueItems": true,
                    "items": {
                        "type": "string"
                    }
                },
                "startWith": {
                    "type": "string"
                },
                "notStartWith": {
                    "type": "string"
                },
                "endWith": {
                    "type": "string"
                },
                "notEndWith": {
                    "type": "string"
                },
                "containProperty": {
                    "$ref": "#/definitions/PropertyName"
                },
                "notContainProperty": {
                    "$ref": "#/definitions/PropertyName"
                },
                "longerThanProperty": {
                    "$ref": "#/definitions/PropertyName"
                },
                "shorterThanProperty": {
                    "$ref": "#/definitions/PropertyName"
                }
            }
        },
        "NumberPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "NumberPropertyOptions",
            "allOf": [
                {
                    "$ref": "#/definitions/CommonNumberPropertyOptions"
                },
                {
                    "properties": {
                        "type": {
                            "const": "number"
                        },
                        "default": {
                            "type": "number"
                        },
                        "isIn": {
                            "type": "array",
                            "items": {
                                "oneOf": [
                                    {
                                        "type": "number"
                                    }
                                ]
                            }
                        },
                        "isNotIn": {
                            "type": "array",
                            "items": {
                                "oneOf": [
                                    {
                                        "type": "number"
                                    }
                                ]
                            }
                        }
                    },
                    "required": [
                        "type"
                    ]
                }
            ]
        },
        "IntegerPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "IntegerPropertyOptions",
            "allOf": [
                {
                    "$ref": "#/definitions/CommonNumberPropertyOptions"
                },
                {
                    "properties": {
                        "type": {
                            "const": "integer"
                        },
                        "default": {
                            "type": "integer"
                        },
                        "isIn": {
                            "type": "array",
                            "items": {
                                "oneOf": [
                                    {
                                        "type": "integer"
                                    }
                                ]
                            }
                        },
                        "isNotIn": {
                            "type": "array",
                            "items": {
                                "oneOf": [
                                    {
                                        "type": "integer"
                                    }
                                ]
                            }
                        }
                    },
                    "required": [
                        "type"
                    ]
                }
            ]
        },
        "BooleanPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "BooleanPropertyOptions",
            "properties": {
                "type": {
                    "const": "boolean"
                },
                "default": {
                    "type": "boolean"
                }
            },
            "required": [
                "type"
            ]
        },
        "DatePropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "DatePropertyOptions",
            "properties": {
                "type": {
                    "const": "date"
                },
                "isFutureDate": {
                    "type": "boolean"
                },
                "isPastDate": {
                    "type": "boolean"
                },
                "default": {
                    "type": "string"
                }
            },
            "required": [
                "type"
            ]
        },
        "ObjectPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "ObjectPropertyOptions",
            "properties": {
                "type": {
                    "const": "object"
                },
                "target": {
                    "$ref": "#/definitions/ModelName"
                },
                "default": {
                    "type": "object"
                }
            },
            "required": [
                "type",
                "target"
            ]
        },
        "ArrayPropertyOptions": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "ArrayPropertyOptions",
            "properties": {
                "type": {
                    "const": "array"
                },
                "default": {
                    "type": "array"
                },
                "minSize": {
                    "type": "integer"
                },
                "maxSize": {
                    "type": "integer"
                },
                "items": {
                    "$ref": "#/definitions/PropertyOptions"
                }
            },
            "required": [
                "type",
                "items"
            ]
        },
        "StringFormat": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "StringFormat",
            "description": "String format such as email, password, uuid, ip6, ip4 and so more",
            "enum": [
                "short",
                "long",
                "object-id"
            ]
        },
        "InputType": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "InputType",
            "description": "UI input type",
            "enum": [
                "text",
                "textarea"
            ]
        },
        "Icon": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Icon",
            "enum": [
                "search",
                "home"
            ]
        }
    }
}